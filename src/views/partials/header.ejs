<header>
    <nav class="container my-3 p-3 bg-secondary text-light bg-gradient rounded shadow">
        <div class="row">
            <div class="col d-flex gap-3 position-relative align-items-center">
                <% if (user) { %>
                    <div class="img-wrapper" style="height: 3em; width: 3em">
                        <img class="rounded-circle" src="<%= user.avatar %>" style="width: 100%; height: 100%; object-fit: cover">
                    </div>
                    <% if (user.role === 'DRIVER') { %>
                        <h1 class="fs-3 mb-0">Driver panel</h1>
                        <a class="btn btn-light" data-bs-toggle="modal" data-bs-target="#createTruckModal">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                 class="bi bi-truck" viewBox="0 0 16 16">
                                <path d="M0 3.5A1.5 1.5 0 0 1 1.5 2h9A1.5 1.5 0 0 1 12 3.5V5h1.02a1.5 1.5 0 0 1 1.17.563l1.481 1.85a1.5 1.5 0 0 1 .329.938V10.5a1.5 1.5 0 0 1-1.5 1.5H14a2 2 0 1 1-4 0H5a2 2 0 1 1-3.998-.085A1.5 1.5 0 0 1 0 10.5v-7zm1.294 7.456A1.999 1.999 0 0 1 4.732 11h5.536a2.01 2.01 0 0 1 .732-.732V3.5a.5.5 0 0 0-.5-.5h-9a.5.5 0 0 0-.5.5v7a.5.5 0 0 0 .294.456zM12 10a2 2 0 0 1 1.732 1h.768a.5.5 0 0 0 .5-.5V8.35a.5.5 0 0 0-.11-.312l-1.48-1.85A.5.5 0 0 0 13.02 6H12v4zm-9 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm9 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
                            </svg>
                            Create truck</a>
                        <form method="get" action="/export">
                            <button type="submit" class="btn btn-light">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                     class="bi bi-file-earmark-spreadsheet" viewBox="0 0 16 16">
                                    <path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V9H3V2a1 1 0 0 1 1-1h5.5v2zM3 12v-2h2v2H3zm0 1h2v2H4a1 1 0 0 1-1-1v-1zm3 2v-2h3v2H6zm4 0v-2h3v1a1 1 0 0 1-1 1h-2zm3-3h-3v-2h3v2zm-7 0v-2h3v2H6z"/>
                                </svg>
                                Export to Excel
                            </button>
                        </form>
                    <%
                    } else { %>
                        <h1 class="fs-3 m-0 me-3">Shipper panel</h1>
                        <a class="btn btn-light" data-bs-toggle="modal" data-bs-target="#createLoadModal">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                 class="bi bi-box-seam-fill" viewBox="0 0 16 16">
                                <path fill-rule="evenodd"
                                      d="M15.528 2.973a.75.75 0 0 1 .472.696v8.662a.75.75 0 0 1-.472.696l-7.25 2.9a.75.75 0 0 1-.557 0l-7.25-2.9A.75.75 0 0 1 0 12.331V3.669a.75.75 0 0 1 .471-.696L7.443.184l.01-.003.268-.108a.75.75 0 0 1 .558 0l.269.108.01.003 6.97 2.789ZM10.404 2 4.25 4.461 1.846 3.5 1 3.839v.4l6.5 2.6v7.922l.5.2.5-.2V6.84l6.5-2.6v-.4l-.846-.339L8 5.961 5.596 5l6.154-2.461L10.404 2Z"/>
                            </svg>
                            Create load</a>
                <% }
                } else { %>
                    <h1 class="fs-3 m-0"><a href="http://localhost:8080"
                                            class="text-white text-decoration-none">Hello!</a></h1>
                <% } %>
            </div>
            <div class="col d-flex justify-content-end gap-3 align-items-center">
                <% if (user) { %>
                    <div class="dropdown">
                        <button class="btn btn-light dropdown-toggle" type="button" data-bs-toggle="dropdown"
                                aria-expanded="false">
                            Account settings
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" data-bs-toggle="modal" href="#"
                                   data-bs-target="#passwordChangeModal">Change password</a></li>
                            <li><a class="dropdown-item" data-bs-toggle="modal" href="#"
                                   data-bs-target="#avatarChangeModal">Change profile photo</a></li>
                        </ul>
                    </div>

                    <a class="btn btn-light" href="http://localhost:8080/logout">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                             class="bi bi-box-arrow-right" viewBox="0 0 16 16">
                            <path fill-rule="evenodd"
                                  d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2z"/>
                            <path fill-rule="evenodd"
                                  d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"/>
                        </svg>
                    </a>
                <% } else { %>
                    <div class="dropdown">
                        <button class="btn btn-light dropdown-toggle" type="button" data-bs-toggle="dropdown"
                                aria-expanded="false">
                            Sign in
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" data-bs-toggle="modal" href="#" data-bs-target="#loginModal">Login</a>
                            </li>
                            <a class="dropdown-item" data-bs-toggle="modal" href="#"
                               data-bs-target="#forgotPasswordModal">Reset
                                password</a></ul>
                    </div>
                    <a class="btn btn-light" data-bs-toggle="modal" data-bs-target="#registerModal">Sign up</a>
                <% } %>
            </div>
        </div>
    </nav>
</header>

<% if (user) {
if (user.role === 'DRIVER') {
%>
    <div class="modal fade" id="createTruckModal" tabindex="-1" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="loginModalLabel">Create truck</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form method="post" action="/create-truck">
                    <div class="modal-body">
                        <select class="form-select" aria-label="Truck select" name="type">
                            <option value="SPRINTER">Sprinter</option>
                            <option value="SMALL STRAIGHT">Small straight</option>
                            <option value="LARGE STRAIGHT">Large straight</option>
                        </select>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary" id="changePasswordBtn">Create truck</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
<% } else { %>
    <div class="modal fade" id="createLoadModal" tabindex="-1"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="loginModalLabel">Create load</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form method="post" action="/create-load">
                    <div class="modal-body">
                        <div class="input-group mb-3">
                            <span class="input-group-text" id="inputGroup-sizing-sm">Load name</span>
                            <input type="text" class="form-control" name="name">
                        </div>
                        <div class="input-group mb-3">
                            <span class="input-group-text" id="inputGroup-sizing-sm">Payload</span>
                            <input type="text" class="form-control" name="payload">
                        </div>
                        <div class="input-group mb-3">
                            <span class="input-group-text" id="inputGroup-sizing-sm">Pickup Address</span>
                            <input type="text" class="form-control" name="pickup_address">
                        </div>
                        <div class="input-group mb-3">
                            <span class="input-group-text" id="inputGroup-sizing-sm">Delivery Address</span>
                            <input type="text" class="form-control" name="delivery_address">
                        </div>
                        <div class="input-group">
                            <span class="input-group-text">Dimensions</span>
                            <input type="text" class="form-control" name="width" placeholder="Width">
                            <input type="text" class="form-control" name="length" placeholder="Length">
                            <input type="text" class="form-control" name="height" placeholder="Height">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary" id="changePasswordBtn">Create load</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
<% } %>

<div class="modal fade" id="avatarChangeModal" tabindex="-1" aria-labelledby="changeAvatarModalLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Change avatar</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form method="post" action="/avatar" enctype="multipart/form-data">
                <div class="modal-body">
                    <div class="input-group mb-3">
                        <label class="input-group-text" for="inputGroupFile01">Upload</label>
                        <input type="file" class="form-control" id="inputGroupFile01" name="avatar">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Save avatar</button>
                </div>
            </form>
        </div>
    </div>
</div>
<% } %>
<%- include('./authModals'); %>